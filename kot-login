#seleniumは標準ライブラリではないので、要インストール
from selenium import webdriver
from selenium.webdriver.support.ui import Select
from selenium.webdriver.common.by import By
import time

#chromeのdriverを保存したパスを指定
driver = webdriver.Chrome("C:\\chromedriver_win32\\chromedriver.exe")

#KOTにアクセス
driver.get('https://s3.kingtime.jp/independent/recorder/personal/')

elem_search_word = driver.find_element_by_id("id")
#ログインIDを入力
elem_search_word.send_keys("7m530000xxxx")

elem_search_word = driver.find_element_by_id("password")
#パスワードを入力
elem_search_word.send_keys("xxxxxxxx")

#OKをクリック
elem_search_btn = driver.find_element_by_class_name('btn-control-message')
elem_search_btn.click()

time.sleep(2)

#画面右上のプルダウンを選択
driver.find_element_by_class_name('menu-icon').click()
time.sleep(1)

#タイムカードを選択し、クリック
driver.find_elements_by_class_name('text-middle')[0].click()

time.sleep(2)

#3/19の打刻編集を選択。htBlock-selectOtherの後の数字とbutton_xxxの数字は日付によって変わる。現状は都度確認が必要なため、要改善。
element = driver.find_elements(By.CLASS_NAME, 'htBlock-selectOther')[18]
select_element = Select(element)
select_element.select_by_value('#button_0560012277919')
time.sleep(2)

#開始～終了までの時間を入力
start = driver.find_elements(By.NAME,"recording_type_code_1")[0]
select_element = Select(start)
select_element.select_by_value('1')

rest1 = driver.find_elements(By.NAME,"recording_type_code_2")[0]
select_element = Select(rest1)
select_element.select_by_value('3')

rest2 = driver.find_elements(By.NAME,"recording_type_code_3")[0]
select_element = Select(rest2)
select_element.select_by_value('4')

end = driver.find_elements(By.NAME,"recording_type_code_4")[0]
select_element = Select(end)
select_element.select_by_value('2')

elem_search_word1 = driver.find_element_by_id("recording_timestamp_time_1")
elem_search_word1.send_keys("0900")

elem_search_word2 = driver.find_element_by_id("recording_timestamp_time_2")
elem_search_word2.send_keys("1200")

elem_search_word3 = driver.find_element_by_id("recording_timestamp_time_3")
elem_search_word3.send_keys("1300")

elem_search_word4 = driver.find_element_by_id("recording_timestamp_time_4")
elem_search_word4.send_keys("2000")

#打刻登録をクリック
elem_search_btn = driver.find_element_by_id("button_01")
elem_search_btn.click()
